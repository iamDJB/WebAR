<script src="https://cdn.jsdelivr.net/gh/aframevr/aframe@1c2407b26c61958baa93967b5412487cd94b290b/dist/aframe-master.min.js"></script>
<script src='https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar-nft.js'></script>

<!-- Video handler script -->
<script>
    window.onload = function() {
        AFRAME.registerComponent('videoHandler', {
            init: function() {
                var marker = this.el;

                this.vid = document.querySelector("#vid");

                marker.addEventListener('markerFound', function() {
                    this.vid.play();
                }.bind(this));

                marker.addEventListener('markerLost', function() {
                    this.vid.pause();
                    this.vid.currentTime = 0;
                }.bind(this));
            }
        });
    };
</script>

<!-- Style -->
<style>
    .arjs-loader {
        height: 100%;
        width: 100%;
        position: absolute;
        top: 0;
        left: 0;
        background-color: rgba(0, 0, 0, 0.8);
        z-index: 9999;
        display: flex;
        justify-content: center;
        align-items: center;
    }

    .arjs-loader div {
        text-align: center;
        font-size: 1.25em;
        color: white;
    }
</style>

<!-- Body -->
<body style='margin : 0px; overflow: hidden;'>
    <div class="arjs-loader">
        <div>- JafTea -</div> 
        <div>Getting your WebAR ready...</div>
    </div>
    <a-scene vr-mode-ui="enabled:false;" renderer='antialias: true; alpha: true; precision: mediump;' embedded arjs='trackingMethod: best; sourceType: webcam; debugUIEnabled: false;'>

        <!-- Asset management system -->
        <a-assets>
            <video src="/assets/videos/sample.mp4" preload="auto" id="vid" response-type="arraybuffer" loop crossorigin webkit-playsinline autoplay muted playsinline></video>
        </a-assets>

        <!-- NFT Video -->
        <a-nft videohandler type="nft" url="./assets/data/jaftea.patt" smooth="true" smoothCount="10" smoothTolerance="0.01" smoothThreshold="5">
            <a-video src="#vid" position="0 0.2 0" rotation="270 0 0" width="300" height="175"></a-video>
        </a-nft>

        <!-- Add a simple camera -->
        <a-entity camera></a-entity>

    </a-scene>
</body>


<!DOCTYPE html>
<html>
    <!-- Load JavaScript libraries -->
    <script src="https://aframe.io/releases/1.0.4/aframe.min.js"></script>
    <script src="https://jeromeetienne.github.io/AR.js/aframe/build/aframe-ar.js"></script>
    
    <!-- Start body -->
    <body style='margin : 0px; overflow: hidden;'>

        <!-- Asset management system -->
        <a-assets>
            <!-- Stone man model -->
            <!-- <a-asset-item id='stone-obj' src='assets/models/Stone.obj'></a-asset-item>
            <a-asset-item id='stone-mtl' src='assets/models/Stone.mtl'></a-asset-item> -->
            <!-- Video -->
            <!-- <video id='video-mp4' autoplay loop='true' muted='true' src='/assets/videos/sample.mp4'></video> -->
            <video id='video-mp4' crossOrigin='anonymous' type='video/mp4' autoplay loop='true' src='/assets/videos/sample.mp4' playsinline webkit-playsinline controls></video>
            <!-- <video id='video-mp4' autoplay loop='true' muted='true' src='https://ia800701.us.archive.org/26/items/SampleVideo1280x7205mb/SampleVideo_1280x720_5mb.mp4'></video> -->
        </a-assets>
    
        <!-- Open AR.js scene -->
        <a-scene embedded arjs='sourceType: webcam; trackingMethod: best; debugUIEnabled: false;' vr-mode-ui='enabled: false;'>
        <!-- <a-scene arjs='detectionMode: mono_and_matrix; matrixCodeType: 3x3;'> -->
        <!-- Note that matrixCodeType can be any one of [3x3, 3x3_HAMMING63, 3x3_PARITY65, 4x4, 4x4_BCH_13_9_3, 4x4_BCH_13_5_5] -->        

            <!-- Handle a marker with custom pattern -->
            <a-marker type='pattern' url='./assets/data/jaftea.patt'>
            <!-- <a-marker type='pattern' url='pattern-jaftea.patt'></a-marker> -->
            <!-- <a-marker type='pattern' patternUrl='C:/Users/dylan/Documents/GitHub/WebAR/pattern-jaftea.patt'></a-marker> -->
                <!-- <a-box position='0 0.5 0' material='color: red;'></a-box> -->
                <!-- <a-entity obj-model='obj: #stone-obj; mtl: #stone-mtl' position='0 0.5 0'></a-entity> -->
                <a-entity>
                    <!-- <a-video type='video/mp4' id='video-mp4' autoplay='false' loop='true' src='assets/videos/sample.mp4' webkit-playsinline></a-video> -->
                    <!-- <a-video position='0 0.5 0' src='#video-mp4' rotation='90 180 0' autoplay='true' loop='true'></a-video> -->
                    <a-video src='#video-mp4' position='0 0.2 0' rotation='270 0 0' play='true'></a-video>
                </a-entity>
            </a-marker>

            <!-- handle marker with hiro preset -->
            <a-marker preset='hiro'>
            <a-box position='0 0.5 0' material='color: green;'></a-box>
            </a-marker>

            <!-- handle barcode marker -->
            <a-marker type='barcode' value='5'>
            <a-box position='0 0.5 0' material='color: blue;'></a-box>
            </a-marker>

            <!-- Add a simple camera -->
            <a-entity camera></a-entity>
        </a-scene>
        
        <!-- Add an additional script to handle video playback -->
        <script>
            window.addEventListener('click', function(){
                var v = document.querySelector('#video-mp4');
                v.play();
                if (v.paused == true) {
                    video.play();
                } else {
                    video.pause();
                }
            }, false);
        </script>
    
    </body>
</html>